# 卷：将磁盘挂载到容器

## 一、介绍卷

### 1.卷的应用示例

### 2.介绍可用的卷类型

- emptyDir
- hostPath
- gitRepo
- nfs
- configMap、secret、downwardAPI
- persistentVolumeClaim

## 二、通过卷在容器之间共享数据

### 1.使用emptyDir卷

- 在pod中使用emptyDir卷
- 创建pod
- 查看pod状态
- 指定用于EMPTYDIR的介质

### 2.使用Git仓库作为存储卷

- 从一个克隆的Git仓库中运行web服务器pod的服务文件
- 确认文件未与Git仓库保持同步
- 介绍sidecar容器
- 使用带有专用Git仓库的gitRepo卷
- 总结GitRepo存储卷

## 三、访问工作节点文件系统上的文件

### 1.介绍hostPath卷

### 2.检查使用hostPath卷的系统pod

## 四、使用持久化存储

### 1.使用GCE持久磁盘作为pod存储卷

- 创建GCE持久磁盘
- 创建一个使用持久GCE持久磁盘卷的pod
- 通过向MongoDB数据库添加文档来将数据写入持久化存储
- 重新创建pod并验证其可以读取前一个pod保存的数据

### 2.通过底层持久化存储使用其他类型的卷

- 使用AWS弹性块存储
- 使用NFS卷
- 使用其他存储技术

## 五、从底层技术解耦pod

### 1.介绍持久卷和持久卷声明

### 2.创建持久卷

### 3.通过创建持久卷声明来获取持久卷

- 创建持久卷声明
- 列举持久卷声明
- 列举持久卷

### 4.在pod中使用持久卷声明

### 5.了解使用持久卷和持久卷声明的好处

### 6.回收持久卷

- 手动回收持久卷
- 自动回收持久卷

## 六、持久卷的动态配置

### 1.通过StorageClass资源定义可用存储类型

### 2.请求持久卷声明中的存储类

- 创建一个请求特定存储类的PVC定义
- 检查所创建的PVC和动态配置的PV
- 了解存储类的使用

### 3.不指定存储类的动态配置

- 列出存储类
- 检查默认存储类
- 创建一个没有指定存储类别的持久卷声明
- 强制将持久卷声明绑定到预配置的其中一个持久卷
- 了解动态持久卷供应的全貌

## 七、本章小结

- 创建一 个多容器 pod, 并通过为 pod 添加 一 个卷并将其挂载到每个容器中，来让 pod 中的容器操作相同的文件
- 使用 emptyDir 卷存储临时的非持久数据
- 使用 gitRepo 卷可以在 pod启动时使用Git库的内容轻松填充目录
- 使用 hostPath 卷从主机节点访问文件
- 将外部存储装载到卷中， 以便在 pod 重启之前保持 pod数据读写
- 通过使用持久卷和持久卷声明解耦 pod 与存储基础架构
- 为每个持久卷声明动态设置所需（或缺省）存储类的持久卷
- 当需要将持久卷声明绑定到预配置的持久卷时， 防止动态置备程序干扰